<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="/logo.png" />
    <link rel="stylesheet" href="/blog-architect3/umi.3ec1f225.css" />
    <script>
      window.routerBase = "/blog-architect3";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>04 | 一切的源头，代码分支策略的选择 - 大师兄</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/持续交付36讲/03.配置管理/01" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-architect3/">大师兄</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span>架构师<ul><li><a aria-current="page" class="active" href="/blog-architect3/持续交付36讲">持续交付36讲</a></li><li><a href="/blog-architect3/容器实战高手课">容器实战高手课</a></li><li><a href="/blog-architect3/ddd实战课">ddd实战课</a></li><li><a href="/blog-architect3/devops实战笔记">devops实战笔记</a></li><li><a href="/blog-architect3/ebpf核心技术与实战">ebpf核心技术与实战</a></li><li><a href="/blog-architect3/深入剖析kubernetes">深入剖析kubernetes</a></li><li><a href="/blog-architect3/openresty从入门到实战">openresty从入门到实战</a></li><li><a href="/blog-architect3/赵成的运维体系管理课">赵成的运维体系管理课</a></li><li><a href="/blog-architect3/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog-architect3/安全攻防技能30讲">安全攻防技能30讲</a></li><li><a href="/blog-architect3/容量保障核心技术与实战">容量保障核心技术与实战</a></li><li><a href="/blog-architect3/深入拆解tomcat和jetty">深入拆解tomcat和jetty</a></li></ul></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;/logo.png&#x27;)" href="/blog-architect3/"></a><h1>大师兄</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li>架构师<ul><li><a aria-current="page" class="active" href="/blog-architect3/持续交付36讲">持续交付36讲</a></li><li><a href="/blog-architect3/容器实战高手课">容器实战高手课</a></li><li><a href="/blog-architect3/ddd实战课">ddd实战课</a></li><li><a href="/blog-architect3/devops实战笔记">devops实战笔记</a></li><li><a href="/blog-architect3/ebpf核心技术与实战">ebpf核心技术与实战</a></li><li><a href="/blog-architect3/深入剖析kubernetes">深入剖析kubernetes</a></li><li><a href="/blog-architect3/openresty从入门到实战">openresty从入门到实战</a></li><li><a href="/blog-architect3/赵成的运维体系管理课">赵成的运维体系管理课</a></li><li><a href="/blog-architect3/性能测试实战30讲">性能测试实战30讲</a></li><li><a href="/blog-architect3/安全攻防技能30讲">安全攻防技能30讲</a></li><li><a href="/blog-architect3/容量保障核心技术与实战">容量保障核心技术与实战</a></li><li><a href="/blog-architect3/深入拆解tomcat和jetty">深入拆解tomcat和jetty</a></li></ul></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a href="/blog-architect3/持续交付36讲">持续交付36讲</a></li><li><a href="/blog-architect3/持续交付36讲/01.开篇词">01.开篇词</a><ul><li><a href="/blog-architect3/持续交付36讲/01.开篇词/01"><span>开篇词 | 量身定制你的持续交付体系</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/02.基本概念">02.基本概念</a><ul><li><a href="/blog-architect3/持续交付36讲/02.基本概念/01"><span>01 | 持续交付到底有什么价值？</span></a></li><li><a href="/blog-architect3/持续交付36讲/02.基本概念/02"><span>02 | 影响持续交付的因素有哪些？</span></a></li><li><a href="/blog-architect3/持续交付36讲/02.基本概念/03"><span>03 | 持续交付和DevOps是一对好基友</span></a></li></ul></li><li><a aria-current="page" class="active" href="/blog-architect3/持续交付36讲/03.配置管理">03.配置管理</a><ul><li><a aria-current="page" class="active" href="/blog-architect3/持续交付36讲/03.配置管理/01"><span>04 | 一切的源头，代码分支策略的选择</span></a></li><li><a href="/blog-architect3/持续交付36讲/03.配置管理/02"><span>05 | 手把手教你依赖管理</span></a></li><li><a href="/blog-architect3/持续交付36讲/03.配置管理/03"><span>06 | 代码回滚，你真的理解吗？</span></a></li><li><a href="/blog-architect3/持续交付36讲/03.配置管理/04"><span>07 |  “两个披萨”团队的代码管理实际案例</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/04.环境管理">04.环境管理</a><ul><li><a href="/blog-architect3/持续交付36讲/04.环境管理/01"><span>08 | 测试环境要多少？从现实需求说起</span></a></li><li><a href="/blog-architect3/持续交付36讲/04.环境管理/02"><span>09 | 测试环境要多少？从成本与效率说起</span></a></li><li><a href="/blog-architect3/持续交付36讲/04.环境管理/03"><span>10 | 让环境自己说话，论环境自描述的重要性</span></a></li><li><a href="/blog-architect3/持续交付36讲/04.环境管理/04"><span>11 | “配置”是把双刃剑，带你了解各种配置方法</span></a></li><li><a href="/blog-architect3/持续交付36讲/04.环境管理/05"><span>12 | 极限挑战，如何做到分钟级搭建环境？</span></a></li><li><a href="/blog-architect3/持续交付36讲/04.环境管理/06"><span>13 | 容器技术真的是环境管理的救星吗？</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/05.构建集成">05.构建集成</a><ul><li><a href="/blog-architect3/持续交付36讲/05.构建集成/01"><span>14 | 如何做到构建的提速，再提速！</span></a></li><li><a href="/blog-architect3/持续交付36讲/05.构建集成/02"><span>15 | 构建检测，无规矩不成方圆</span></a></li><li><a href="/blog-architect3/持续交付36讲/05.构建集成/03"><span>16 | 构建资源的弹性伸缩</span></a></li><li><a href="/blog-architect3/持续交付36讲/05.构建集成/04"><span>17 | 容器镜像构建的那些事儿</span></a></li><li><a href="/blog-architect3/持续交付36讲/05.构建集成/05"><span>18 | 如何做好容器镜像的个性化及合规检查？</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/06.发布及监控">06.发布及监控</a><ul><li><a href="/blog-architect3/持续交付36讲/06.发布及监控/01"><span>19  | 发布是持续交付的最后一公里</span></a></li><li><a href="/blog-architect3/持续交付36讲/06.发布及监控/02"><span>20 | Immutable！任何变更都需要发布</span></a></li><li><a href="/blog-architect3/持续交付36讲/06.发布及监控/03"><span>21 | 发布系统一定要注意用户体验</span></a></li><li><a href="/blog-architect3/持续交付36讲/06.发布及监控/04"><span>22 | 发布系统的核心架构和功能设计</span></a></li><li><a href="/blog-architect3/持续交付36讲/06.发布及监控/05"><span>23 | 业务及系统架构对发布的影响</span></a></li><li><a href="/blog-architect3/持续交付36讲/06.发布及监控/06"><span>24 | 如何利用监控保障发布质量？</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/07.测试管理">07.测试管理</a><ul><li><a href="/blog-architect3/持续交付36讲/07.测试管理/01"><span>25 | 代码静态检查实践</span></a></li><li><a href="/blog-architect3/持续交付36讲/07.测试管理/02"><span>26 | 越来越重要的破坏性测试</span></a></li><li><a href="/blog-architect3/持续交付36讲/07.测试管理/03"><span>27 | 利用Mock与回放技术助力自动化回归</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/08.持续交付平台化">08.持续交付平台化</a><ul><li><a href="/blog-architect3/持续交付36讲/08.持续交付平台化/01"><span>28 | 持续交付为什么要平台化设计？</span></a></li><li><a href="/blog-architect3/持续交付36讲/08.持续交付平台化/02"><span>29 | 计算资源也是交付的内容</span></a></li><li><a href="/blog-architect3/持续交付36讲/08.持续交付平台化/03"><span>30 | 持续交付中有哪些宝贵数据？</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/09.持续交付移动app">09.持续交付移动App</a><ul><li><a href="/blog-architect3/持续交付36讲/09.持续交付移动app/01"><span>31 | 了解移动App的持续交付生命周期</span></a></li><li><a href="/blog-architect3/持续交付36讲/09.持续交付移动app/02"><span>32 | 细谈移动APP的交付流水线（pipeline）</span></a></li><li><a href="/blog-architect3/持续交付36讲/09.持续交付移动app/03"><span>33 | 进阶，如何进一步提升移动APP的交付效率？</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/10.实践案例">10.实践案例</a><ul><li><a href="/blog-architect3/持续交付36讲/10.实践案例/01"><span>34 | 快速构建持续交付系统（一）：需求分析</span></a></li><li><a href="/blog-architect3/持续交付36讲/10.实践案例/02"><span>35 | 快速构建持续交付系统（二）：GitLab 解决代码管理问题</span></a></li><li><a href="/blog-architect3/持续交付36讲/10.实践案例/03"><span>36 | 快速构建持续交付系统（三）：Jenkins 解决集成打包问题</span></a></li><li><a href="/blog-architect3/持续交付36讲/10.实践案例/04"><span>37 | 快速构建持续交付系统（四）：Ansible 解决自动部署问题</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/11.特别放送">11.特别放送</a><ul><li><a href="/blog-architect3/持续交付36讲/11.特别放送/01"><span>持续交付专栏特别放送 | 答疑解惑</span></a></li><li><a href="/blog-architect3/持续交付36讲/11.特别放送/02"><span>持续交付专栏特别放送 | 高效学习指南</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/12.结束语">12.结束语</a><ul><li><a href="/blog-architect3/持续交付36讲/12.结束语/01"><span>结束语 | 越痛苦的事，越要经常做</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/13.结课测试">13.结课测试</a><ul><li><a href="/blog-architect3/持续交付36讲/13.结课测试/01"><span>结课测试｜这些持续交付的相关知识，你都掌握了吗？</span></a></li></ul></li><li><a href="/blog-architect3/持续交付36讲/summary">持续交付36讲</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="谈谈主干开发（TBD）" data-depth="2"><a href="/blog-architect3/持续交付36讲/03.配置管理/01#谈谈主干开发tbd"><span>谈谈主干开发（TBD）</span></a></li><li title="谈谈特性分支开发" data-depth="2"><a href="/blog-architect3/持续交付36讲/03.配置管理/01#谈谈特性分支开发"><span>谈谈特性分支开发</span></a></li><li title="选出最适合的分支策略" data-depth="2"><a href="/blog-architect3/持续交付36讲/03.配置管理/01#选出最适合的分支策略"><span>选出最适合的分支策略</span></a></li><li title="国内互联网公司的选择" data-depth="2"><a href="/blog-architect3/持续交付36讲/03.配置管理/01#国内互联网公司的选择"><span>国内互联网公司的选择</span></a></li><li title="总结" data-depth="2"><a href="/blog-architect3/持续交付36讲/03.配置管理/01#总结"><span>总结</span></a></li><li title="思考题" data-depth="2"><a href="/blog-architect3/持续交付36讲/03.配置管理/01#思考题"><span>思考题</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="04--一切的源头代码分支策略的选择"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#04--一切的源头代码分支策略的选择"><span class="icon icon-link"></span></a>04 | 一切的源头，代码分支策略的选择</h1><p>记得大概是一年前吧，我与好友老吴喝茶聊天时，讨论到：高效的持续交付体系，必定需要一个合适的代码分支策略。</p><p>我告诉老吴：“采用不同的代码分支策略，意味着实施不同的代码集成与上线流程，这会影响整个研发团队每日的协作方式，因此研发团队通常会很认真地选择自己的策略。”</p><p>老吴是一名有多年开发经验的资深架构师，当时正好要接手一个框架团队，从个人贡献者向团队管理者转型。他个人对代码管理工具可谓熟之又熟，甚至连“老古董”的CVS都可以跟你聊半天。但他在为团队制定代码分支管理策略时，还是慎之又慎，足见其重要性。</p><p>最后我们发现，要确定选用哪种代码分支管理策略，需要先假设几个问题，这几个问题有了答案，也就代表你找到了适合的方向。</p><p>你需要思考的几个问题如下：</p><ol><li><p>Google和Facebook这两个互联网大咖都在用主干开发（Trunk Based Development，简称TBD），我们是不是也参照它俩，采用主干开发分支策略？</p></li><li><p>用Google搜索一下，会发现有个排名很靠前的分支策略，叫“A successful Git branching model”（简称 Git Flow），它真的好用吗？团队可以直接套用吗？</p></li><li><p>GitHub 和 GitLab 这两个当下最流行的代码管理平台，各自推出了 GitHub Flow 和 GitLab Flow，它们有什么区别？适合我使用吗？</p></li><li><p>像阿里、携程和美团点评这样国内知名的互联网公司，都在用什么样的分支策略？</p></li></ol><p>今天，我想再沿着当时的思考路径，和你一起回顾和总结一下，希望能够带你全面了解代码分支策略，帮助你做出合适的选择。</p><h2 id="谈谈主干开发tbd"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#谈谈主干开发tbd"><span class="icon icon-link"></span></a>谈谈主干开发（TBD）</h2><p><strong>主干开发是一个源代码控制的分支模型，开发者在一个称为 “trunk” 的分支（Git 称 master） 中对代码进行协作，除了发布分支外没有其他开发分支。</strong></p><p>Google和 Facebook都是采用“主干开发”的方式，代码一般直接提交到主干的头部，这样可以保证所有用户看到的都是同一份代码的最新版本。</p><p><strong>“主干开发”确实避免了合并分支时的麻烦，因此像Google这样的公司一般就不采用分支开发，分支只用来发布。</strong></p><p>大多数时候，发布分支是主干某个时点的快照。以后的改Bug和功能增强，都是提交到主干，必要时 cherry-pick （选择部分变更集合并到其他分支）到发布分支。与主干长期并行的特性分支极为少见。</p><p>由于不采用“特性分支开发”，所有提交的代码都被集成到了主干，为了保证主干上线后的有效性，一般会使用特性切换（feature toggle）。特性切换就像一个开关可以在运行期间隐藏、启用或禁用特定功能，项目团队可以借助这种方式加速开发过程。</p><p>特性切换在大型项目持续交付中变得越来越重要，因为它有助于将部署从发布中解耦出来。但据吉姆 · 伯德（Jim Bird）介绍，特性切换会导致代码更脆弱、更难测试、更难理解和维护、更难提供技术支持，而且更不安全。</p><p>他的主要论据是，将未经测试的代码引入生产环境是一个糟糕的主意，它们引发的问题可能会在无意间暴露出来。另外，越来越多的特性切换会使得逻辑越来越混乱。</p><p><strong>特性切换需要健壮的工程过程、可靠的技术设计和成熟的特性切换生命周期管理</strong>，如果不具备这三个关键的条件，使用特性切换反而会降低生产力。</p><p>根据上面的分析，主干开发的分支策略虽然有利于开展持续交付，但是它对开发团队的能力要求也更高。</p><p>主干开发的优缺点如表1所示。<br/><img src="/blog-architect3/static/httpsstatic001geekbangorgresourceimage595e59096cdc19f9e0a5fefbe99f9b57445e.f9bd14bf.png" alt=""/></p><p>表1 主干开发的优缺点</p><h2 id="谈谈特性分支开发"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#谈谈特性分支开发"><span class="icon icon-link"></span></a>谈谈特性分支开发</h2><p>和主干开发相对的是 “特性分支开发” 。在这个大类里面，我会给你分析Git Flow、GitHub Flow和 GitLab Flow这三个常用的模型。</p><p><strong>第一，Git Flow</strong></p><p>我们在Google上查关键词“branch model”（也就是“分支模型”），有一篇排名比较靠前的文章“A successful Git branching model”，它介绍了Git Flow模型。</p><p>Git刚出来的那些年，可参考的模型不多，所以Git Flow模型在2011年左右被大家当作了推荐的分支模型，至今也还有项目团队在使用。然而，Git Flow烦琐的流程也被许多研发团队吐槽，大家普遍认为hotfix和 release 分支显得多余，平时都不会去用。</p><p><img src="/blog-architect3/static/httpsstatic001geekbangorgresourceimage4b0f4bc4c4035857479b2126fed5af4ce90f.7e8ca7f6.png" alt=""/></p><p>图1 Git Flow示意图</p><p><strong>第二，GitHub Flow</strong></p><p>GitHub Flow 是 GitHub 所使用的一种简单流程。该流程只使用master和特性分支，并借助 GitHub 的 pull request 功能。</p><p><img src="/blog-architect3/static/httpsstatic001geekbangorgresourceimage7a147ae8a5fe4f5fcdae7ba9cfaf758f1a14.798c104a.png" alt=""/></p><p>图2 GitHub Flow示意图</p><p><strong>在 GitHub Flow 中，master 分支中包含稳定的代码，它已经或即将被部署到生产环境。任何开发人员都不允许把未测试或未审查的代码直接提交到 master 分支。对代码的任何修改，包括Bug 修复、热修复、新功能开发等都在单独的分支中进行。不管是一行代码的小改动，还是需要几个星期开发的新功能，都采用同样的方式来管理。</strong></p><p>当需要修改时，从 master 分支创建一个新的分支，所有相关的代码修改都在新分支中进行。开发人员可以自由地提交代码和提交到远程仓库。</p><p>当新分支中的代码全部完成之后，通过 GitHub 提交一个新的 pull request。团队中的其他人员会对代码进行审查，提出相关的修改意见。由持续集成服务器（如 Jenkins）对新分支进行自动化测试。当代码通过自动化测试和代码审查之后，该分支的代码被合并到 master 分支。再从 master 分支部署到生产环境。</p><p>GitHub Flow 的好处在于非常简单实用，开发人员需要注意的事项非常少，很容易形成习惯。当需要修改时，只要从 master 分支创建新分支，完成之后通过 pull request 和相关的代码审查，合并回 master 分支就可以了。</p><p><strong>第三，GitLab Flow</strong></p><p>上面提到的GitHub Flow，适用于特性分支合入master后就能马上部署到线上的这类项目，但并不是所有团队都使用GitHub或使用pull request功能，而是使用开源平台GitLab，特别是对于公司级别而言，代码作为资产，不会随意维护在较公开的GitHub上（除非采用企业版）。</p><p>GitLab Flow 针对不同的发布场景，在GitHub Flow（特性分支加master分支）的基础上做了改良，额外衍生出了三个子类模型，如表2所示。<br/><img src="/blog-architect3/static/httpsstatic001geekbangorgresourceimage0e340efbe615c847aac070fdb9b8a588a434.3ba743f9.png" alt=""/></p><p>表2 GitLab Flow 的三个分支</p><p><img src="data:image/jpeg;base64,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" alt=""/></p><p>图3 带生产分支的GitLab Flow</p><p><img src="data:image/jpeg;base64,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" alt=""/></p><p>图4 带环境分支的GitLab Flow</p><p><img src="data:image/jpeg;base64,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" alt=""/></p><p>图5 带发布分支的GitLab Flow</p><p>GitLab Flow的特性分支合入master用的是“Merge Request”，功能与GitHub Flow的“pull request”相同，这里不再赘述。</p><p>通过Git Flow、GitHub Flow和 GitLab Flow（3个衍生类别） 这几个具体模型的介绍，我给你总结一下特性分支开发的优缺点。如表3所示。</p><p><img src="/blog-architect3/static/httpsstatic001geekbangorgresourceimagea5b1a517f2b1c48c8de54e500df3996628b1.5b1b2c2c.png" alt=""/></p><p>表3特性分支开发的优缺点</p><h2 id="选出最适合的分支策略"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#选出最适合的分支策略"><span class="icon icon-link"></span></a>选出最适合的分支策略</h2><p>上面我跟你讲到的分支模型，都是IT研发领域比较流行的。虽然有些策略带上了代码平台的标识，如GitHub Flow，但并不意味着该策略仅限于GitHub代码平台使用，你完全可以在自己搭建的代码平台上使用这些策略。</p><p>接下来，我就总体归纳一下什么情况下应该选择什么样的分支策略。如表4所示。<br/><img src="/blog-architect3/static/httpsstatic001geekbangorgresourceimageaed9ae29f0b5a96306f49ce485c1823b23d9.324a801e.png" alt=""/></p><p>表4 不同情况适用的代码分支策略</p><h2 id="国内互联网公司的选择"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#国内互联网公司的选择"><span class="icon icon-link"></span></a>国内互联网公司的选择</h2><p>GitLab作为最优秀的开源代码平台，被多数互联网大公司（包括阿里、携程和美团点评等）所使用，这些大厂也都采用特性分支开发策略。当然，这些大公司在长期持续交付实践中，会结合各自公司的情况做个性化的定制。</p><p>比如，携程公司在GitHub Flow的基础上，通过自行研发的集成加速器（Light Merge）和持续交付Paas平台，一起完成集成和发布。</p><p>再比如，阿里的AoneFlow，采用的是主干分支、特性分支和发布分支三种分支类型，再加上自行研发的Aone协同平台，实现持续交付。</p><h2 id="总结"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#总结"><span class="icon icon-link"></span></a>总结</h2><p>今天，我主要给你介绍了各种代码分支策略的特性。</p><p>你应该已经比较清晰地理解了“主干开发”和“特性分支开发”两种策略的各自特性：</p><ol><li><p>“主干开发”集成效率高，冲突少，但对团队个人的开发能力有较高要求；</p></li><li><p>“特性分支开发”有利于并行开发，需要一定的流程保证，能保证主干代码质量。</p></li></ol><p>相信在没有绝对自信能力的情况下，面对绝大多数的场景，企业还是会选择“特性分支开发”的策略。所以，我给你介绍了几种主流的特性分支方法，并对比了各类策略的优劣，以及它们适用的场景。</p><p>接下来，你就可以根据自己所在项目的具体情况，参考今天的内容，裁剪出最适合自己团队的分支策略了。</p><h2 id="思考题"><a aria-hidden="true" tabindex="-1" href="/blog-architect3/持续交付36讲/03.配置管理/01#思考题"><span class="icon icon-link"></span></a>思考题</h2><ol><li><p>开源性质的项目，为什么不适合用主干开发的分支策略？</p></li><li><p>如果你所在的团队只有5人，而且迭代周期为1周，你会采用什么样的分支策略？</p></li></ol><p>欢迎你给我留言。</p></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/GGwujun/blog/edit/master/ssrc/持续交付36讲/03.配置管理/01.md">在 GitHub 上编辑此页<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="最后更新时间：">2023/9/29 14:48:00</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-149864185-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/blog-architect3/umi.0a9ffe80.js"></script>
  </body>
</html>
